---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: attic
  namespace: default
spec:
  values:
    initContainers:
      03-db-migrations:
        image: ghcr.io/qlonik/attic-develop:171c89fbe0f099e8bf6e466a1a1a12578f703f0e@sha256:910e1457607f161327b04750f5b04cec9245fa54af3603e092b70ba09df54743
        envFrom:
          - secretRef:
              name: attic-credentials
        args:
          - /app/result/bin/atticd
          - --config
          - /config/server.toml
          - --mode
          - db-migrations
        volumeMounts:
          - name: config
            subPath: server.toml
            mountPath: /config/server.toml
            readOnly: true
